{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///E:/GuestLinked/guestlinked/lib/supabaseClient.js"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nlet supabaseInstance;\r\n\r\nexport const getSupabase = () => {\r\n  if (!supabaseInstance) {\r\n    if (!supabaseUrl || !supabaseAnonKey) {\r\n      throw new Error('Missing Supabase environment variables. Please check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.');\r\n    }\r\n    supabaseInstance = createBrowserClient(supabaseUrl, supabaseAnonKey);\r\n  }\r\n  return supabaseInstance;\r\n};\r\n\r\n// Export a direct reference for easier usage\r\nexport const supabase = getSupabase();\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN,IAAI;AAEG,MAAM,cAAc;IACzB,IAAI,CAAC,kBAAkB;QACrB,uCAAsC;;QAEtC;QACA,mBAAmB,CAAA,GAAA,0KAAA,CAAA,sBAAmB,AAAD,EAAE,aAAa;IACtD;IACA,OAAO;AACT;AAGO,MAAM,WAAW","debugId":null}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///E:/GuestLinked/guestlinked/app/buyer/add-agent/page.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { getSupabase } from '@/lib/supabaseClient';\r\n\r\nexport default function AddAgent() {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const router = useRouter();\r\n\r\n  const [formData, setFormData] = useState({\r\n    agentName: '',\r\n    agentEmail: '',\r\n    tempPassword: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    const checkUser = async () => {\r\n      const supabase = getSupabase();\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (!user) {\r\n        router.push('/');\r\n        return;\r\n      }\r\n\r\n      // Fetch user settings to verify role\r\n      const { data: settings, error: settingsError } = await supabase\r\n        .from('users_settings_tb')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      if (settingsError || !settings) {\r\n        console.error('Error fetching user settings:', settingsError);\r\n        router.push('/');\r\n        return;\r\n      }\r\n\r\n      // Only buyers can add agents\r\n      if (settings.role !== 'Buyer') {\r\n        if (settings.role === 'Seller') {\r\n          router.push('/seller/seller-dashboard');\r\n        } else if (settings.role === 'Agent') {\r\n          router.push('/agent/dashboard');\r\n        } else {\r\n          router.push('/dashboard');\r\n        }\r\n        return;\r\n      }\r\n\r\n      setUser(user);\r\n      setLoading(false);\r\n    };\r\n\r\n    checkUser();\r\n  }, [router]);\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const generateTempPassword = () => {\r\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    let password = '';\r\n    for (let i = 0; i < 12; i++) {\r\n      password += chars.charAt(Math.floor(Math.random() * chars.length));\r\n    }\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      tempPassword: password\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!formData.agentName.trim()) {\r\n      setMessage('Agent name is required');\r\n      return;\r\n    }\r\n\r\n    if (!formData.agentEmail.trim()) {\r\n      setMessage('Agent email is required');\r\n      return;\r\n    }\r\n\r\n    if (!formData.tempPassword.trim()) {\r\n      setMessage('Please generate a temporary password');\r\n      return;\r\n    }\r\n\r\n    setSubmitting(true);\r\n    setMessage('');\r\n\r\n    try {\r\n      // Call the invite agent API\r\n      const response = await fetch('/api/invite-agent', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          agentName: formData.agentName,\r\n          agentEmail: formData.agentEmail,\r\n          tempPassword: formData.tempPassword,\r\n          buyerUserId: user.id\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (response.ok && result.success) {\r\n        setMessage('Agent invitation sent successfully! They can now log in with the provided credentials.');\r\n        setFormData({\r\n          agentName: '',\r\n          agentEmail: '',\r\n          tempPassword: ''\r\n        });\r\n        \r\n        // Redirect to agents list after 3 seconds\r\n        setTimeout(() => {\r\n          router.push('/buyer/agents');\r\n        }, 3000);\r\n      } else {\r\n        setMessage(result.error || 'Failed to send agent invitation');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error inviting agent:', error);\r\n      setMessage('An error occurred while sending the invitation');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-900 flex items-center justify-center\">\r\n        <div className=\"text-white text-xl\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-white\">\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"max-w-2xl mx-auto\">\r\n          <div className=\"mb-8\">\r\n            <button\r\n              onClick={() => router.back()}\r\n              className=\"text-blue-400 hover:text-blue-300 transition-colors duration-200 mb-4\"\r\n            >\r\n              ‚Üê Back\r\n            </button>\r\n            <h1 className=\"text-3xl font-bold mb-2\">Add New Agent</h1>\r\n            <p className=\"text-gray-400\">\r\n              Create a new agent account that will have access to your websites and orders.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n              <div>\r\n                <label htmlFor=\"agentName\" className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Agent Name *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"agentName\"\r\n                  name=\"agentName\"\r\n                  value={formData.agentName}\r\n                  onChange={handleInputChange}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  placeholder=\"Enter agent's full name\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"agentEmail\" className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Agent Email *\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  id=\"agentEmail\"\r\n                  name=\"agentEmail\"\r\n                  value={formData.agentEmail}\r\n                  onChange={handleInputChange}\r\n                  className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  placeholder=\"Enter agent's email address\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"tempPassword\" className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  Temporary Password *\r\n                </label>\r\n                <div className=\"flex space-x-2\">\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"tempPassword\"\r\n                    name=\"tempPassword\"\r\n                    value={formData.tempPassword}\r\n                    onChange={handleInputChange}\r\n                    className=\"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    placeholder=\"Generate or enter temporary password\"\r\n                    required\r\n                  />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={generateTempPassword}\r\n                    className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors duration-200\"\r\n                  >\r\n                    Generate\r\n                  </button>\r\n                </div>\r\n                <p className=\"text-xs text-gray-400 mt-1\">\r\n                  The agent will need to change this password on first login\r\n                </p>\r\n              </div>\r\n\r\n              {message && (\r\n                <div className={`p-3 rounded-md ${\r\n                  message.includes('successfully') || message.includes('sent') \r\n                    ? 'bg-green-900 text-green-300' \r\n                    : 'bg-red-900 text-red-300'\r\n                }`}>\r\n                  {message}\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"flex space-x-4\">\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={submitting}\r\n                  className=\"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white py-2 px-4 rounded-md transition-colors duration-200\"\r\n                >\r\n                  {submitting ? 'Sending Invitation...' : 'Send Agent Invitation'}\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => router.back()}\r\n                  className=\"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n\r\n          <div className=\"mt-8 bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Agent Access</h2>\r\n            <div className=\"space-y-2 text-gray-300\">\r\n              <p>‚Ä¢ Agents will have access to all your websites and orders</p>\r\n              <p>‚Ä¢ They can browse and place orders on your behalf</p>\r\n              <p>‚Ä¢ They cannot modify your account settings or add other agents</p>\r\n              <p>‚Ä¢ You can revoke agent access at any time</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;QACvC,WAAW;QACX,YAAY;QACZ,cAAc;IAChB;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,YAAY;YAChB,MAAM,WAAW,CAAA,GAAA,qHAAA,CAAA,cAAW,AAAD;YAC3B,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;YAEtD,IAAI,CAAC,MAAM;gBACT,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,qCAAqC;YACrC,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,SACpD,IAAI,CAAC,qBACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,MAAM;YAET,IAAI,iBAAiB,CAAC,UAAU;gBAC9B,QAAQ,KAAK,CAAC,iCAAiC;gBAC/C,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,6BAA6B;YAC7B,IAAI,SAAS,IAAI,KAAK,SAAS;gBAC7B,IAAI,SAAS,IAAI,KAAK,UAAU;oBAC9B,OAAO,IAAI,CAAC;gBACd,OAAO,IAAI,SAAS,IAAI,KAAK,SAAS;oBACpC,OAAO,IAAI,CAAC;gBACd,OAAO;oBACL,OAAO,IAAI,CAAC;gBACd;gBACA;YACF;YAEA,QAAQ;YACR,WAAW;QACb;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,MAAM,oBAAoB,CAAC;QACzB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAA,OAAQ,CAAC;gBACnB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE;YACV,CAAC;IACH;IAEA,MAAM,uBAAuB;QAC3B,MAAM,QAAQ;QACd,IAAI,WAAW;QACf,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,IAAK;YAC3B,YAAY,MAAM,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,MAAM;QAClE;QACA,YAAY,CAAA,OAAQ,CAAC;gBACnB,GAAG,IAAI;gBACP,cAAc;YAChB,CAAC;IACH;IAEA,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI,CAAC,SAAS,SAAS,CAAC,IAAI,IAAI;YAC9B,WAAW;YACX;QACF;QAEA,IAAI,CAAC,SAAS,UAAU,CAAC,IAAI,IAAI;YAC/B,WAAW;YACX;QACF;QAEA,IAAI,CAAC,SAAS,YAAY,CAAC,IAAI,IAAI;YACjC,WAAW;YACX;QACF;QAEA,cAAc;QACd,WAAW;QAEX,IAAI;YACF,4BAA4B;YAC5B,MAAM,WAAW,MAAM,MAAM,qBAAqB;gBAChD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,WAAW,SAAS,SAAS;oBAC7B,YAAY,SAAS,UAAU;oBAC/B,cAAc,SAAS,YAAY;oBACnC,aAAa,KAAK,EAAE;gBACtB;YACF;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAElC,IAAI,SAAS,EAAE,IAAI,OAAO,OAAO,EAAE;gBACjC,WAAW;gBACX,YAAY;oBACV,WAAW;oBACX,YAAY;oBACZ,cAAc;gBAChB;gBAEA,0CAA0C;gBAC1C,WAAW;oBACT,OAAO,IAAI,CAAC;gBACd,GAAG;YACL,OAAO;gBACL,WAAW,OAAO,KAAK,IAAI;YAC7B;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,WAAW;QACb,SAAU;YACR,cAAc;QAChB;IACF;IAEA,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BAAqB;;;;;;;;;;;IAG1C;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,SAAS,IAAM,OAAO,IAAI;gCAC1B,WAAU;0CACX;;;;;;0CAGD,8OAAC;gCAAG,WAAU;0CAA0B;;;;;;0CACxC,8OAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;;kCAK/B,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAK,UAAU;4BAAc,WAAU;;8CACtC,8OAAC;;sDACC,8OAAC;4CAAM,SAAQ;4CAAY,WAAU;sDAA+C;;;;;;sDAGpF,8OAAC;4CACC,MAAK;4CACL,IAAG;4CACH,MAAK;4CACL,OAAO,SAAS,SAAS;4CACzB,UAAU;4CACV,WAAU;4CACV,aAAY;4CACZ,QAAQ;;;;;;;;;;;;8CAIZ,8OAAC;;sDACC,8OAAC;4CAAM,SAAQ;4CAAa,WAAU;sDAA+C;;;;;;sDAGrF,8OAAC;4CACC,MAAK;4CACL,IAAG;4CACH,MAAK;4CACL,OAAO,SAAS,UAAU;4CAC1B,UAAU;4CACV,WAAU;4CACV,aAAY;4CACZ,QAAQ;;;;;;;;;;;;8CAIZ,8OAAC;;sDACC,8OAAC;4CAAM,SAAQ;4CAAe,WAAU;sDAA+C;;;;;;sDAGvF,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDACC,MAAK;oDACL,IAAG;oDACH,MAAK;oDACL,OAAO,SAAS,YAAY;oDAC5B,UAAU;oDACV,WAAU;oDACV,aAAY;oDACZ,QAAQ;;;;;;8DAEV,8OAAC;oDACC,MAAK;oDACL,SAAS;oDACT,WAAU;8DACX;;;;;;;;;;;;sDAIH,8OAAC;4CAAE,WAAU;sDAA6B;;;;;;;;;;;;gCAK3C,yBACC,8OAAC;oCAAI,WAAW,CAAC,eAAe,EAC9B,QAAQ,QAAQ,CAAC,mBAAmB,QAAQ,QAAQ,CAAC,UACjD,gCACA,2BACJ;8CACC;;;;;;8CAIL,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,MAAK;4CACL,UAAU;4CACV,WAAU;sDAET,aAAa,0BAA0B;;;;;;sDAE1C,8OAAC;4CACC,MAAK;4CACL,SAAS,IAAM,OAAO,IAAI;4CAC1B,WAAU;sDACX;;;;;;;;;;;;;;;;;;;;;;;kCAOP,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAA6B;;;;;;0CAC3C,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOjB","debugId":null}}]
}