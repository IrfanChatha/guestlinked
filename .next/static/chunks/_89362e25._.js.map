{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///E:/GuestLinked/guestlinked/lib/supabaseClient.js"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nlet supabaseInstance;\r\n\r\nexport const getSupabase = () => {\r\n  if (!supabaseInstance) {\r\n    if (!supabaseUrl || !supabaseAnonKey) {\r\n      throw new Error('Missing Supabase environment variables. Please check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.');\r\n    }\r\n    supabaseInstance = createBrowserClient(supabaseUrl, supabaseAnonKey);\r\n  }\r\n  return supabaseInstance;\r\n};\r\n\r\n// Export a direct reference for easier usage\r\nexport const supabase = getSupabase();\r\n"],"names":[],"mappings":";;;;AAEoB;AAFpB;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN,IAAI;AAEG,MAAM,cAAc;IACzB,IAAI,CAAC,kBAAkB;QACrB,uCAAsC;;QAEtC;QACA,mBAAmB,CAAA,GAAA,6KAAA,CAAA,sBAAmB,AAAD,EAAE,aAAa;IACtD;IACA,OAAO;AACT;AAGO,MAAM,WAAW","debugId":null}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///E:/GuestLinked/guestlinked/app/buyer/agents/page.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { getSupabase } from '@/lib/supabaseClient';\r\n\r\nexport default function AgentsList() {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [agents, setAgents] = useState([]);\r\n  const [agentsLoading, setAgentsLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const checkUser = async () => {\r\n      const supabase = getSupabase();\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (!user) {\r\n        router.push('/');\r\n        return;\r\n      }\r\n\r\n      // Fetch user settings to verify role\r\n      const { data: settings, error: settingsError } = await supabase\r\n        .from('users_settings_tb')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .single();\r\n\r\n      if (settingsError || !settings) {\r\n        console.error('Error fetching user settings:', settingsError);\r\n        router.push('/');\r\n        return;\r\n      }\r\n\r\n      // Only buyers can access this page\r\n      if (settings.role !== 'Buyer') {\r\n        if (settings.role === 'Seller') {\r\n          router.push('/seller/seller-dashboard');\r\n        } else if (settings.role === 'Agent') {\r\n          router.push('/agent/dashboard');\r\n        } else {\r\n          router.push('/dashboard');\r\n        }\r\n        return;\r\n      }\r\n\r\n      setUser(user);\r\n      setLoading(false);\r\n      fetchAgents(user.id);\r\n    };\r\n\r\n    checkUser();\r\n  }, [router]);\r\n\r\n  const fetchAgents = async (buyerId) => {\r\n    setAgentsLoading(true);\r\n    try {\r\n      const supabase = getSupabase();\r\n      const { data: agentsData, error } = await supabase\r\n        .from('users_settings_tb')\r\n        .select('*')\r\n        .eq('parent_buyer_id', buyerId)\r\n        .eq('role', 'Agent')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching agents:', error);\r\n        setMessage('Error loading agents');\r\n      } else {\r\n        setAgents(agentsData || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in fetchAgents:', error);\r\n      setMessage('Error loading agents');\r\n    } finally {\r\n      setAgentsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteAgent = async (agentId, agentName) => {\r\n    if (!confirm(`Are you sure you want to remove agent \"${agentName}\"? This action cannot be undone.`)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Call API to delete agent\r\n      const response = await fetch('/api/delete-agent', {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ agentId }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (response.ok && result.success) {\r\n        setMessage('Agent removed successfully');\r\n        fetchAgents(user.id); // Refresh the list\r\n      } else {\r\n        setMessage(result.error || 'Failed to remove agent');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error removing agent:', error);\r\n      setMessage('An error occurred while removing the agent');\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-900 flex items-center justify-center\">\r\n        <div className=\"text-white text-xl\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-white\">\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"max-w-6xl mx-auto\">\r\n          <div className=\"flex justify-between items-center mb-8\">\r\n            <div>\r\n              <button\r\n                onClick={() => router.back()}\r\n                className=\"text-blue-400 hover:text-blue-300 transition-colors duration-200 mb-4\"\r\n              >\r\n                ‚Üê Back\r\n              </button>\r\n              <h1 className=\"text-3xl font-bold mb-2\">My Agents</h1>\r\n              <p className=\"text-gray-400\">\r\n                Manage agents who can access your websites and place orders on your behalf.\r\n              </p>\r\n            </div>\r\n            <button\r\n              onClick={() => router.push('/buyer/add-agent')}\r\n              className=\"bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-medium transition-colors duration-200\"\r\n            >\r\n              Add New Agent\r\n            </button>\r\n          </div>\r\n\r\n          {message && (\r\n            <div className={`mb-6 p-4 rounded-lg ${\r\n              message.includes('successfully') \r\n                ? 'bg-green-900 text-green-300' \r\n                : 'bg-red-900 text-red-300'\r\n            }`}>\r\n              {message}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            {agentsLoading ? (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"text-gray-400\">Loading agents...</div>\r\n              </div>\r\n            ) : agents.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <div className=\"text-gray-400 mb-4\">No agents found</div>\r\n                <p className=\"text-gray-500 mb-6\">\r\n                  You haven't added any agents yet. Agents can help you manage your orders and browse websites.\r\n                </p>\r\n                <button\r\n                  onClick={() => router.push('/buyer/add-agent')}\r\n                  className=\"bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-medium transition-colors duration-200\"\r\n                >\r\n                  Add Your First Agent\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <h2 className=\"text-xl font-semibold\">\r\n                    {agents.length} Agent{agents.length !== 1 ? 's' : ''}\r\n                  </h2>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {agents.map((agent) => (\r\n                    <div key={agent.user_id} className=\"bg-gray-700 rounded-lg p-6\">\r\n                      <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center\">\r\n                            <span className=\"text-white font-semibold\">\r\n                              {agent.name.charAt(0).toUpperCase()}\r\n                            </span>\r\n                          </div>\r\n                          <div>\r\n                            <h3 className=\"font-semibold\">{agent.name}</h3>\r\n                            <p className=\"text-sm text-gray-400\">{agent.email}</p>\r\n                          </div>\r\n                        </div>\r\n                        <span className=\"bg-green-900 text-green-300 px-2 py-1 rounded text-xs\">\r\n                          Active\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-2 text-sm text-gray-300 mb-4\">\r\n                        <div className=\"flex justify-between\">\r\n                          <span>Role:</span>\r\n                          <span className=\"text-blue-400\">{agent.role}</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between\">\r\n                          <span>Added:</span>\r\n                          <span>{formatDate(agent.created_at)}</span>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex space-x-2\">\r\n                        <button\r\n                          onClick={() => handleDeleteAgent(agent.user_id, agent.name)}\r\n                          className=\"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-md transition-colors duration-200 text-sm\"\r\n                        >\r\n                          Remove Agent\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"mt-8 bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Agent Permissions</h2>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <h3 className=\"font-medium text-green-400 mb-2\">What Agents Can Do:</h3>\r\n                <ul className=\"space-y-1 text-sm text-gray-300\">\r\n                  <li>‚Ä¢ View all your websites</li>\r\n                  <li>‚Ä¢ Browse available websites</li>\r\n                  <li>‚Ä¢ Place orders on your behalf</li>\r\n                  <li>‚Ä¢ View existing orders</li>\r\n                  <li>‚Ä¢ Access buyer dashboard features</li>\r\n                </ul>\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-medium text-red-400 mb-2\">What Agents Cannot Do:</h3>\r\n                <ul className=\"space-y-1 text-sm text-gray-300\">\r\n                  <li>‚Ä¢ Modify account settings</li>\r\n                  <li>‚Ä¢ Add or remove other agents</li>\r\n                  <li>‚Ä¢ Access billing information</li>\r\n                  <li>‚Ä¢ Change passwords</li>\r\n                  <li>‚Ä¢ Delete your account</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":"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","debugId":null}}]
}